<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width", initial-scale="1.0"/>
		<meta http-equiv="X-UA-Compatible" content="ie=edge"/>
		<title>Skills</title>
		

		<style>

			@import url("https://fonts.googleapis.com/css2?family=Roboto:wght@100&display=swap" );
			@import url("https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" );
			
			body{
				margin: 0;
				padding:0; 
				overflow: hidden;
			}
			

			canvas{
				width: 100%;
   				height: 100%;
			}



			.btn_container{
				position:absolute;
				height: 100%;
				width: 100%;
				display: flex;
				flex-direction: column;
				justify-content: center;
				
				
			}
			.btn_Panel{
				position: relative;
				margin: auto;
				padding-bottom: 180px;
				height: 50%;
				width:60%;
				display: flex;
				justify-content: center;
		
			}

			.btn_next{
				position:absolute;
				right: 0px;
				width: 24%;
				height: 100%;
				pointer-events: fill;
				cursor:pointer;
			}

			.btn_enter{
				position:absolute;
				width:30%;
				height: 100%;
				pointer-events: fill;
				cursor:pointer;
			}

			
			.btn_prev{
				position:absolute;
				left: 0px;
				width:24%;
				height: 100%;
				pointer-events: fill;
				cursor:pointer;
			}

			.btn_info{
				position:absolute;
				right: 60px;
				bottom: 30px;
				display: flex;
				justify-content: right;
				width: 60%;
				
			}

			
			i{
				
				padding: 0 6px 0;
				color:#FFF;
	  			opacity: 60%;
			}

			.bottom_container{
				position: absolute;
				bottom: 15px;
				width: 100%;
				display: flex;
				justify-content: center;
			}

			.bottom_box
			{
				position: relative;
				font-family: "Roboto", sans-serif;
				color: rgba(255, 255, 255, 0.6); 
			}

			.element {
				position: absolute;
				width: 120px;
				height: 135px;
				background-color: rgba(0,127,127,0.5);
				box-shadow: 0px 0px 12px rgba(0,255,255,0.75);
				border: 1px solid rgba(127,255,255,0.75);
				font-family: Helvetica, sans-serif;
				text-align: center;
				line-height: normal;
				cursor: default;
			}

			.element:hover {
				box-shadow: 0px 0px 12px rgba(0,255,255,0.5);
				border: 1px solid rgba(127,255,255,0.25);
			}

			.element .logo {
				position: relative;
				top: 36%;
				left: 50%;

				width: 120px;
				height: 120px;
				background-image:url(./images/Logo_javascript.png);
				background-size: 100% 100%;
				transform: translate(-50%, -50%);
			}

			.element .title {
				position: relative;
				bottom: 15px;
				left: 0px;
				right: 0px;
				font-size: 12px;
				color: rgba(127,255,255,0.75);
			}
             
		</style>

        
        
	</head>
	<body>   

		<div class="element">
			<div class="logo"></div>
			<div class="title">Photoshop</div>
		</div>
	

	<script src="./js/three.js"></script> 

	<script type="x-shader/x-vertex" id="vertexshader">

		uniform float amplitude;

		attribute vec3 displacement;
		attribute vec3 customColor;

		varying vec3 vColor;

		void main() {

			vec3 newPosition = position + amplitude * displacement;

			vColor = customColor;

			gl_Position = projectionMatrix * modelViewMatrix * vec4( newPosition, 1.0 );

		}

	</script>

	<script type="x-shader/x-fragment" id="fragmentshader">

		uniform vec3 color;
		uniform float opacity;

		varying vec3 vColor;

		void main() {

			gl_FragColor = vec4( vColor * color, opacity );

		}

	</script>

	<script type="importmap">
		{
			"imports": {
				"three": "./build/three.module.js",				
				"three/addons/": "./jsm/"             
			}
		}

		
		
	</script>

	
	
	<script type="module">

		import * as THREE from 'three';

		import { TIFFLoader } from 'three/addons/loaders/TIFFLoader.js';

		///Post Processing///
		import { GUI } from 'three/addons/libs/lil-gui.module.min.js';
		import { EffectComposer } from 'three/addons/postprocessing/EffectComposer.js';
		import { RenderPass } from 'three/addons/postprocessing/RenderPass.js';
		import { UnrealBloomPass } from 'three/addons/postprocessing/UnrealBloomPass.js';

		import { FontLoader } from 'three/addons/loaders/FontLoader.js';
		import { TextGeometry } from 'three/addons/geometries/TextGeometry.js';
		import { CSS3DRenderer, CSS3DObject } from 'three/addons/renderers/CSS3DRenderer.js';
		

		//////Post Processing/////

		let camera, scene, renderer, stats;
		let renderer_css3d;
		

		let mixer;

		let rotationManu = new THREE.Object3D();
		let rotationTarget = new THREE.Object3D();
		let HUD_rpm=1;

		let HUD = new THREE.Object3D();
		let HUD_A = new THREE.Object3D();
		let HUD_B = new THREE.Object3D();
		let HUD_C = new THREE.Object3D();
		let HUD_D = new THREE.Object3D();
		let HUD_E = new THREE.Object3D();

		let index=0;

		const divisionAngle = Math.PI/3;

		let image_01, image_02, image_03, image_04, image_05, image_06;

		let imageGroup_01 = new THREE.Object3D();
		let imageGroup_02 = new THREE.Object3D();
		let imageGroup_03 = new THREE.Object3D();
		let imageGroup_04 = new THREE.Object3D();
		let imageGroup_05 = new THREE.Object3D();
		let imageGroup_06 = new THREE.Object3D();

		const textPos = new THREE.Vector3(0,39,0);
		const model_scale = 0.25 ;

		const ImagePos = new THREE.Vector3(0,15,-36);
		const mirrorImagePos = new THREE.Vector3(0,-36,-30);
		const quaternion_rotationTarget = new THREE.Quaternion();
		const quaternion_rotationManu = new THREE.Quaternion();
		const imageScale =15;
		const mirrorImageOpacity = 0.45;

		const clock = new THREE.Clock();
		const load_image_01 = './images/Logo_threejs.png';
		const load_image_02 = './images/Logo_unity.png';
		const load_image_03 = './images/Logo_unreal.png';
		const load_image_04 = './images/Logo_javascript.png';
		const load_image_05 = './images/Logo_illustrator.png';
		const load_image_06 = './images/Logo_photoshop.png';

		let text_info = "Three.js";

		let line, uniforms,text_geometry, loader, shaderMaterial;
		let lable_javascript;


	//	const loader = new FontLoader();
	//		loader.load( 'fonts/helvetiker_bold.typeface.json', function ( font ) {
//
	//			init( font );
//
	//		} );

        init();
        animate();
		demo_anim();

function init() {

    
    
	const container = document.createElement( 'div' );
	document.body.appendChild( container );

	camera = new THREE.PerspectiveCamera( 40, window.innerWidth / window.innerHeight, 1, 2000 );
	camera.position.set(0,75,-150);
	camera.lookAt(0,18,0);

	scene = new THREE.Scene();
	
	renderer = new THREE.WebGLRenderer( { alpha: true, antialias: true } );
	renderer.setPixelRatio( window.devicePixelRatio );
	renderer.setSize( window.innerWidth, window.innerHeight );
	renderer.shadowMap.enabled = true;
	//renderer.setClearColor(0x000000, 0.0);//需加入這一條，否則看不到CSS的底圖
	
	let ambientLight = new THREE.AmbientLight(0xE1DDD2, 1);

	let hemiLight = new THREE.HemisphereLight( 0xE5E5DE, 0x000000, 0.9 ); //(上半球顏色,下半球顏色,強度)
	hemiLight.position.set( 0, 0, 0 );

	//scene.add(ambientLight).add(hemiLight);

	uniforms = {

	amplitude: { value: 5.0 },
	opacity: { value: 0.3 },
	color: { value: new THREE.Color( 0x256C92 ) }

	};

	shaderMaterial = new THREE.ShaderMaterial( {

	uniforms: uniforms,
	vertexShader: document.getElementById( 'vertexshader' ).textContent,
	fragmentShader: document.getElementById( 'fragmentshader' ).textContent,
	blending: THREE.AdditiveBlending,
	depthTest: false,
	transparent: true

	} );

	loader = new FontLoader();
	loader.load( 'fonts/helvetiker_bold.typeface.json', function ( font ) {

		text_geometry = new TextGeometry( text_info, {
		
		font: font,
		
		size: 45,
		depth: 15,
		curveSegments: 10,
		
		bevelThickness: 5,
		bevelSize: 1.5,
		bevelEnabled: true,
		bevelSegments: 10,

		} );

		text_geometry.center();

		const count = text_geometry.attributes.position.count;

		const displacement = new THREE.Float32BufferAttribute( count * 3, 3 );
		text_geometry.setAttribute( 'displacement', displacement );

		const customColor = new THREE.Float32BufferAttribute( count * 3, 3 );
		text_geometry.setAttribute( 'customColor', customColor );

		const color = new THREE.Color( 0xffffff );

		for ( let i = 0, l = customColor.count; i < l; i ++ ) {
		
		color.setHSL( i / l, 0.5, 0.5 );
		color.toArray( customColor.array, i * customColor.itemSize );

		}

		const modelscale = new THREE.Vector3(model_scale,model_scale,model_scale*0.5);
		line = new THREE.Line( text_geometry, shaderMaterial );
		line.position.copy(textPos);
		//line.rotation.x = 0.1;
		line.rotation.y = Math.PI;
		line.scale.copy(modelscale);
		scene.add( line );

	} );

	SpriteTag(lable_javascript,"url(./images/Logo_javascript.png)","Javascript");
	renderer_css3d = new CSS3DRenderer();


	const element = document.createElement( 'div' );
	element.className = 'element';

	const logo = document.createElement( 'div' );
	logo.className = 'logo';
	element.appendChild( logo );

	const title = document.createElement( 'div' );
	title.className = 'title';
	title.textContent = "nice";
	element.appendChild( title );

	const objectCSS = new CSS3DObject( element );

	scene.add(objectCSS);
	
	//第1張圖
	const map_01 = new THREE.TextureLoader().load(load_image_01);
	image_01 = new THREE.Sprite( new THREE.SpriteMaterial({ map: map_01, color: 0xFFFFFF, transparent: true, blending: THREE.AdditiveBlending, opacity:1}) );
	image_01.position.copy(ImagePos);
	image_01.scale.set( imageScale, imageScale, 1 );
	image_01.center.set( 0.5, 0.5 );
	
	imageGroup_01.add(image_01);


	//第2張圖
	const map_02 = new THREE.TextureLoader().load(load_image_02 );
	image_02 = new THREE.Sprite( new THREE.SpriteMaterial({ map: map_02}) );
	image_02.position.copy( ImagePos );
	image_02.scale.set( imageScale, imageScale, 1 );
	image_02.center.set( 0.5, 0.5 );

	imageGroup_02.add(image_02);


	//第3張圖
	const map_03 = new THREE.TextureLoader().load(load_image_03);
	image_03 = new THREE.Sprite( new THREE.SpriteMaterial({ map: map_03}) );
	image_03.position.copy( ImagePos );
	image_03.scale.set( imageScale, imageScale, 1 );
	image_03.center.set( 0.5, 0.5 );

	imageGroup_03.add(image_03);


	//第4張圖
	const map_04 = new THREE.TextureLoader().load(load_image_04);
	image_04 = new THREE.Sprite( new THREE.SpriteMaterial({ map: map_04}) );
	image_04.position.copy( ImagePos );
	image_04.scale.set( imageScale, imageScale, 1 );
	image_04.center.set( 0.5, 0.5 );

	imageGroup_04.add(image_04);


	//第5張圖
	const map_05 = new THREE.TextureLoader().load(load_image_05);
	image_05 = new THREE.Sprite( new THREE.SpriteMaterial({ map: map_05}) );
	image_05.position.copy( ImagePos );
	image_05.scale.set( imageScale, imageScale, 1 );
	image_05.center.set( 0.5, 0.5 );

	imageGroup_05.add(image_05);


	//第6張圖
	const map_06 = new THREE.TextureLoader().load(load_image_06);
	image_06 = new THREE.Sprite( new THREE.SpriteMaterial({ map: map_06}) );
	image_06.position.copy( ImagePos );
	image_06.scale.set( imageScale, imageScale, 1 );
	image_06.center.set( 0.5, 0.5 );

	imageGroup_06.add(image_06);

	imageGroup_02.rotation.y=divisionAngle;
	imageGroup_03.rotation.y=divisionAngle*2;
	imageGroup_04.rotation.y=divisionAngle*3;
	imageGroup_05.rotation.y=divisionAngle*4;
	imageGroup_06.rotation.y=divisionAngle*5;
	imageGroup_01.rotation.y=divisionAngle*6;

	rotationManu.add(imageGroup_01).add(imageGroup_02).add(imageGroup_03).add(imageGroup_04).add(imageGroup_05).add(imageGroup_06);

	scene.add(rotationManu).add(rotationTarget);


	///載入模型底下的HUD圖片///
	
	const loader_HUD_A = new TIFFLoader();

	const geometry_HUD_A = new THREE.PlaneGeometry();

	loader_HUD_A.load( './images/HUD_A_20230813.tif', function ( texture ) {

		texture.colorSpace = THREE.SRGBColorSpace;

		const material_HUD_A = new THREE.MeshBasicMaterial( { map: texture, transparent: true, blending: THREE.AdditiveBlending, opacity:1 ,depthWrite: false } );

		const mesh_HUD_A = new THREE.Mesh( geometry_HUD_A, material_HUD_A );
		const img_scale =51;

		mesh_HUD_A.position.set( 0, -0.5, 0 );
		mesh_HUD_A.scale.set(img_scale*2,img_scale*2,1);
		mesh_HUD_A.rotation.x=-Math.PI/2;
		HUD_A.add(mesh_HUD_A);

		setTimeout(() => {scene.add( HUD_A );}, 500);//10分鐘更新一次

		//scene.add( HUD_A );

	} );

	const loader_HUD_B = new TIFFLoader();

	const geometry_HUD_B = new THREE.PlaneGeometry();

	loader_HUD_B.load( './images/HUD_B_20230813.tif', function ( texture ) {

		texture.colorSpace = THREE.SRGBColorSpace;

		const material_HUD_B = new THREE.MeshBasicMaterial( { color: 0x256C92,map: texture, transparent: true, blending: THREE.AdditiveBlending, opacity:0.36,depthWrite: false } );

		const mesh_HUD_B = new THREE.Mesh( geometry_HUD_B, material_HUD_B );
		const img_scale =48;

		mesh_HUD_B.position.set( 0, -0.4, 0 );
		mesh_HUD_B.scale.set(img_scale*2,img_scale*2,1);
		mesh_HUD_B.rotation.x=-Math.PI/2;
		HUD_B.add(mesh_HUD_B);

		setTimeout(() => {scene.add( HUD_B );}, 800);

		//scene.add( HUD_B );

	} );

	const loader_HUD_C = new TIFFLoader();

	const geometry_HUD_C = new THREE.PlaneGeometry();

	loader_HUD_C.load( './images/HUD_C_20230813.tif', function ( texture ) {

		texture.colorSpace = THREE.SRGBColorSpace;

		const material_HUD_C = new THREE.MeshBasicMaterial( { color: 0x256C92,map: texture, transparent: true, blending: THREE.AdditiveBlending, opacity:0.9,depthWrite: false } );

		const mesh_HUD_C = new THREE.Mesh( geometry_HUD_C, material_HUD_C );
		const img_scale =48;

		mesh_HUD_C.position.set( 0, 1.3, 0 );
		mesh_HUD_C.scale.set(img_scale*2,img_scale*2,1);
		mesh_HUD_C.rotation.x=-Math.PI/2;
		HUD_C.add(mesh_HUD_C);

		setTimeout(() => {scene.add( HUD_C );}, 1100);

		//scene.add( HUD_C );

	} );

	const loader_HUD_D = new TIFFLoader();

	const geometry_HUD_D = new THREE.PlaneGeometry();

	loader_HUD_D.load( './images/HUD_D_20230813.tif', function ( texture ) {

		texture.colorSpace = THREE.SRGBColorSpace;

		const material_HUD_D = new THREE.MeshBasicMaterial( { color: 0x256C92,map: texture, transparent: true, blending: THREE.AdditiveBlending, opacity:0.45,depthWrite: false } );

		const mesh_HUD_D = new THREE.Mesh( geometry_HUD_D, material_HUD_D );
		const img_scale =60;

		mesh_HUD_D.position.set( 0, -12.2, 0 );
		mesh_HUD_D.scale.set(img_scale*2,img_scale*2,1);
		mesh_HUD_D.rotation.x=-Math.PI/2;
		HUD_D.add(mesh_HUD_D);

		setTimeout(() => {scene.add( HUD_D );}, 1400);

		//scene.add( HUD_D );

	} );

	const loader_HUD_E = new TIFFLoader();

	const geometry_HUD_E = new THREE.PlaneGeometry();

	loader_HUD_E.load( './images/HUD_E_20230813.tif', function ( texture ) {

		texture.colorSpace = THREE.SRGBColorSpace;

		const material_HUD_E = new THREE.MeshBasicMaterial( { color: 0x256C92,map: texture, transparent: true, blending: THREE.AdditiveBlending, opacity:0.45,depthWrite: false } );

		const mesh_HUD_E = new THREE.Mesh( geometry_HUD_E, material_HUD_E );
		const img_scale =60;

		mesh_HUD_E.position.set( 0, -18.1, 0 );
		mesh_HUD_E.scale.set(img_scale*2,img_scale*2,1);
		mesh_HUD_E.rotation.x=-Math.PI/2;
		HUD_E.add(mesh_HUD_E);

		setTimeout(() => {scene.add( HUD_E );}, 1700);
		//scene.add( HUD_E );

	} );

	/////////////////////////



	window.addEventListener( 'resize', onWindowResize );


    //把3D渲染效果加入網頁視窗中
	container.appendChild( renderer.domElement );
	container.appendChild( renderer_css3d.domElement );
 
	
}

function onWindowResize() {

	camera.aspect = window.innerWidth / window.innerHeight;
	camera.updateProjectionMatrix();

	renderer.setSize( window.innerWidth, window.innerHeight );
	renderer_css3d.setSize( window.innerWidth, window.innerHeight );
}




//類似Unity的Update()功能
function animate() {

	requestAnimationFrame( animate );
	

	renderer.render( scene, camera );
	//renderer_css3d.render( scene, camera );

	
    const delta = clock.getDelta();

	if ( mixer ) mixer.update( delta );


	UpdateRotationManu();



	HUD_A.rotation.y +=0.036*HUD_rpm;
	HUD_B.rotation.y -=0.005*HUD_rpm;
	HUD_C.rotation.y +=0.02*HUD_rpm;
	HUD_D.rotation.y -=0.0001*HUD_rpm;
	HUD_E.rotation.y +=0.001*HUD_rpm;
	
	//console.log(image_01.position.z);
	//HighLightEffect();

	const time = Date.now() * 0.001;
//
////line.rotation.y = 0.25 * time;
//
//uniforms.amplitude.value = Math.sin( 0.5 * time );
//uniforms.color.value.offsetHSL( 0.0005, 0, 0 );
//
//const attributes = line.geometry.attributes;
//const array = attributes.displacement.array;
//
//for ( let i = 0, l = array.length; i < l; i += 3 ) {
//
//	array[ i ] += 0.3 * ( 0.5 - Math.random() );
//	array[ i + 1 ] += 0.3 * ( 0.5 - Math.random() );
//	array[ i + 2 ] += 0.3 * ( 0.5 - Math.random() );
////
//}
//
//attributes.displacement.needsUpdate = true;
}


function ManuRotate(value)
{
	var _value=value;


	if(_value>0)
	{
		rotationTarget.rotation.y-=divisionAngle;
	}

	else if(_value<0)
	{
		rotationTarget.rotation.y+=divisionAngle;
	}

	if(index>5)
	{
		index=0;
		text_info=`Three.js`;
	}
	
	
}

function UpdateRotationManu()
{
	
	quaternion_rotationTarget.setFromEuler(rotationTarget.rotation);

	if(quaternion_rotationManu.angleTo(quaternion_rotationTarget)>0.01)
    {
		quaternion_rotationManu.slerp(quaternion_rotationTarget,0.1);
    } 

	rotationManu.rotation.setFromQuaternion(quaternion_rotationManu);
    
}

async function demo_anim()
{
	setTimeout(() => {RemoveText();index++;SetupText();}, 5999);//1000=1sec}
    setTimeout(() => {ManuRotate(1);UpdateText();}, 6000);//1000=1sec}
	setTimeout(() => {demo_anim();}, 9000);
}

function RemoveText()
{
	scene.remove(line);
}

function SetupText()
{
	switch(index)
	{
		case 0:
		text_info=`Three.js`;
		break;

		case 1:
		text_info=`Unity`;
		break;

		case 2:
		text_info=`Unreal Engine`;
		break;

		case 3:
		text_info=`Javascript`;
		break;

		case 4:
		text_info=`Illustrator`;
		break;

		case 5:
		text_info=`Photoshop`;
		break;
	}	

}

function UpdateText()
{
	//console.log(index);

	loader = new FontLoader();
	loader.load( 'fonts/helvetiker_bold.typeface.json', function ( font ) {

	text_geometry = new TextGeometry( text_info, {

	font: font,

	size: 45,
	depth: 15,
	curveSegments: 10,

	bevelThickness: 5,
	bevelSize: 1.5,
	bevelEnabled: true,
	bevelSegments: 10,

	} );

	text_geometry.center();

	const count = text_geometry.attributes.position.count;

	const displacement = new THREE.Float32BufferAttribute( count * 3, 3 );
	text_geometry.setAttribute( 'displacement', displacement );

	const customColor = new THREE.Float32BufferAttribute( count * 3, 3 );
	text_geometry.setAttribute( 'customColor', customColor );

	const color = new THREE.Color( 0xffffff );

	for ( let i = 0, l = customColor.count; i < l; i ++ ) {

	color.setHSL( i / l, 0.5, 0.5 );
	color.toArray( customColor.array, i * customColor.itemSize );

	}

	const modelscale = new THREE.Vector3(model_scale,model_scale,model_scale*0.5);
	line = new THREE.Line( text_geometry, shaderMaterial );
	line.position.copy(textPos);
	line.rotation.x = 0.2;
	line.rotation.y = Math.PI;
	line.scale.copy(modelscale);
	scene.add( line );

	} );
}

function SpriteTag(tagetObjetCSS,logo_url,logo_title)
{
	const element = document.createElement( 'div' );
	element.className = 'element';
					

	const logo = document.createElement( 'div' );
	logo.className = 'logo';
	logo.style.backgroundImage = logo_url;
	element.appendChild( logo );

	const title = document.createElement( 'div' );
	title.className = 'title';
	title.textContent = logo_title;
	element.appendChild( title );

	tagetObjetCSS = new CSS3DObject( element );
	scene.add( tagetObjetCSS );

}

	</script>






	</body>
</html>
